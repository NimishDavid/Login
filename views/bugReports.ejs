<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Bug Reports</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
      <!-- Modal -->
      <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <h5 class="modal-title" id="exampleModalLabel"><h3>Bug Details</h3></h5>
            </div>
            <div class="modal-body">
              <form>
                  <div class="row">
                      <div class="col-sm-12">
                          <div class="form-group">
                            <label for="bug_name" class="form-control-label">Bug Name</label>
                            <input type="text" class="form-control" id="bug_name" value="" disabled>
                          </div>
                      </div>
                  </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                          <label for="bug_id" class="form-control-label">Bug ID</label>
                          <input type="text" class="form-control" id="bug_id" value="" disabled>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="form-group">
                          <label for="bug_type" class="form-control-label">Bug Type</label>
                          <input type="text" class="form-control" id="bug_type" value="" disabled>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <label for="description" class="form-control-label">Description</label>
                        <textarea class="form-control" id="description" disabled></textarea>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-4">
                        <label for="priority" class="form-control-label">Priority</label>
                        <input type="text" class="form-control" id="priority" value="" disabled>
                    </div>
                    <div class="col-sm-4">
                        <label for="severity" class="form-control-label">Severity</label>
                        <input type="text" class="form-control" id="severity" value="" disabled>
                    </div>
                    <div class="col-sm-4">
                        <label for="current_status" class="form-control-label">Current Status</label>
                        <input type="text" class="form-control" id="current_status" value="" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-4">
                        <label for="project_id" class="form-control-label">Project</label>
                        <input type="text" class="form-control" id="project_id" value="" oninput="getProjectID()" disabled>
                    </div>
                    <div class="col-sm-4">
                        <label for="tester_id" class="form-control-label">Tester</label>
                        <input type="text" class="form-control" id="tester_id" value="" disabled>
                    </div>
                    <div class="col-sm-4">
                        <label for="developer_id" class="form-control-label">Developer</label>
                        <input type="text" class="form-control" id="developer_id" value="" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-4">
                        <label for="project_manager" class="form-control-label">Project Manager</label>
                        <input type="text" class="form-control" id="project_manager" value="" disabled>
                    </div>
                    <div class="col-sm-4">
                        <label for="file" class="form-control-label">File</label>
                        <input type="text" class="form-control" id="file" value="" disabled>
                    </div>
                    <div class="col-sm-4">
                        <label for="date" class="form-control-label">Date</label>
                        <input type="text" class="form-control" id="date" value="" disabled>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <label for="screenshot" class="form-control-label">Screenshot</label>
                        <img class="img-responsive" id="scrImg" src="" alt="image" />
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <label for="method" class="form-control-label">Method</label>
                        <input type="text" class="form-control" id="method" value="" disabled>
                    </div>
                    <div class="col-sm-2">
                        <label for="file" class="form-control-label">Line</label>
                        <input type="line" class="form-control" id="line" value="" disabled>
                    </div>
                    <% if(typeof(resultAdmin) != 'undefined') { %>
                        <% if(state == 'unassigned') { %>
                          <div class="col-sm-4">
                              <label for="developer" class="form-control-label">Developer</label>
                              <div class="dev_id">

                                      <select class="form-control" name="developer" id="devResult"  required>
                                       <!-- <option value="">Select Developer</option> -->

                                      </select>
                                      <div class="help-block with-errors"></div>

                              </div>
                          </div>
                        <% } %>
                        <% if(state == 'approve') { %>
                          <div class="col-sm-4">
                              <label for="status" class="form-control-label">Status</label>
                              <div class="stat">
                                  <select class="form-control" name="status" onchange="rejectCheck($(this))">
                                   <option value="">Select status</option>
                                   <option value="Approve Reject">Reject</option>
                                   <option value="Closed">Closed</option>
                                  </select>
                              </div>
                          </div>
                        <% } %>
                    <% } %>
                </div>
                <div class="row ifReject" style="display: none;">
                    <div class="col-sm-12">
                        <label for="reason" class="form-control-label">Reason</label>
                        <input type="text" class="form-control" id="reason" value="">
                    </div>
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <% if(typeof(resultAdmin) != 'undefined') { %>
                  <% if(state == 'unassigned') { %>
                    <button class="btn btn-sm btn-primary update">Assign</button>
                  <% } %>
                  <% if(state == 'approve') { %>
                    <button class="btn btn-sm btn-primary update">Save</button>
                  <% } %>
              <% } %>
              <button type="button" class="btn btn-sm btn-danger" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
      <!-- Modal -->
    <% include navbar %>
    <div class="container">
    	<div class="row">
			<div class="col-md-12">
                    <% if(typeof(resultAdmin) != 'undefined') { %>
                        <% if(state == 'unassigned') { %>
                            <div class="panel panel-primary resp">
            					<div class="panel-heading">
            						<h3 class="panel-title">Unassigned Bugs</h3>
            						<div class="pull-right">
            							<span class="clickable filter" data-toggle="tooltip" title="Toggle table filter" data-container="body">
                                            <i class="fa fa-filter" aria-hidden="true"></i>
            							</span>
            						</div>
            					</div>
            					<div class="panel-body">
            						<div class="panel-filter">
            						  <input type="text" class="form-control" id="dev-table-filter" data-action="filter" data-filters="#dev-table" placeholder="Filter Bugs" />
            						</div>
                        <table class="table table-hover table-responsive" id="dev-table">
              						<thead>
              							<tr>
              								<th>#</th>
              								<th>Name</th>
              								<th>Type</th>
                                              <th>Severity</th>
                                              <th>Priority</th>
                                              <th>Project</th>
                                              <th></th>
              							</tr>
              						</thead>
                                      <tbody>
                                      <% for(i=0; i<resultAdmin.length; i++) {%>
                                          <% if(resultAdmin[i].status == 'Open') {%>

                                              <tr>
                  								<td class="bug_id"><%= resultAdmin[i].bugID %></td>
                  								<td><%= resultAdmin[i].bugName %></td>
                  								<td><%= resultAdmin[i].bugType %></td>
                                                  <td><%= resultAdmin[i].severity %></td>
                                                  <td><%= resultAdmin[i].priority %></td>
                                                  <td><%= resultAdmin[i].projectName %></td>

                                                  <td class="text-center">
                                                      <button type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#exampleModal" data-bug="<%= resultAdmin[i].bugID %>">View More</button>
                                                  </td>
                  							</tr>

                                          <% } %>
                                      <% } %>
              						</tbody>
              					</table>
            					</div>
                        <% } %> <!--If state is unassigned -->

                        <% if(state == 'assigned') { %>

                            <div class="panel panel-primary resp">
            					<div class="panel-heading">
            						<h3 class="panel-title">Assigned Bugs</h3>
            						<div class="pull-right">
            							<span class="clickable filter" data-toggle="tooltip" title="Toggle table filter" data-container="body">
                                            <i class="fa fa-filter" aria-hidden="true"></i>
            							</span>
            						</div>
            					</div>
            					<div class="panel-body">
            						<div class="panel-filter">
            						  <input type="text" class="form-control" id="dev-table-filter" data-action="filter" data-filters="#dev-table" placeholder="Filter Bugs" />
            						</div>
                        <table class="table table-hover" id="dev-table">
              						<thead>
              							<tr>
              								<th>Bug #</th>
              								<th>Name</th>
              								<th>Type</th>
              								<th>Severity</th>
                                              <th>Priority</th>
                                              <th>Project</th>
                                              <th>Assigned to</th>
                                              <th>Status</th>
                                              <th></th>
              							</tr>
              						</thead>
                                      <tbody>
                                      <% for(i=0; i<resultAdmin.length; i++) {%>
                                          <% if((resultAdmin[i].status != 'Open') && (resultAdmin[i].status != 'Closed')) {%>

                                              <tr>
                  								<td class="bug_id"><%= resultAdmin[i].bugID %></td>
                  								<td><%= resultAdmin[i].bugName %></td>
                  								<td><%= resultAdmin[i].bugType %></td>
                  								<td><%= resultAdmin[i].severity %></td>
                                                  <td><%= resultAdmin[i].priority %></td>
                                                  <td><%= resultAdmin[i].projectName %></td>
                                                  <td><%= resultAdmin[i].assignedToName %></td>
                                                  <td><%= resultAdmin[i].status %></td>
                                                  <td>
                                                      <button type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#exampleModal" data-bug="<%= resultAdmin[i].bugID %>">View More</button>
                                                  </td>
                  							</tr>

                                          <% } %>
                                      <% } %>
              						</tbody>
              					</table>
            					</div>


                        <% } %> <!-- If state is assigned -->

                        <% if(state == 'closed') { %>

                            <div class="panel panel-primary resp">
            					<div class="panel-heading">
            						<h3 class="panel-title">Closed Bugs</h3>
            						<div class="pull-right">
            							<span class="clickable filter" data-toggle="tooltip" title="Toggle table filter" data-container="body">
                                            <i class="fa fa-filter" aria-hidden="true"></i>
            							</span>
            						</div>
            					</div>
            					<div class="panel-body">
            						<div class="panel-filter">
            						  <input type="text" class="form-control" id="dev-table-filter" data-action="filter" data-filters="#dev-table" placeholder="Filter Bugs" />
            						</div>
                        <table class="table table-hover" id="dev-table">
              						<thead>
              							<tr>
                                              <th>Bug #</th>
              								<th>Name</th>
              								<th>Type</th>
              								<th>Severity</th>
                                              <th>Priority</th>
                                              <th>Project</th>
                                              <th>Assigned to</th>
                                              <th>Status</th>
                                              <th></th>
              							</tr>
              						</thead>
                                      <tbody>
                                      <% for(i=0; i<resultAdmin.length; i++) {%>
                                          <% if(resultAdmin[i].status == 'Closed') {%>

                                              <tr>
                                                  <td class="bug_id"><%= resultAdmin[i].bugID %></td>
                  								<td><%= resultAdmin[i].bugName %></td>
                  								<td><%= resultAdmin[i].bugType %></td>
                  								<td><%= resultAdmin[i].severity %></td>
                                                  <td><%= resultAdmin[i].priority %></td>
                                                  <td><%= resultAdmin[i].projectName %></td>
                                                  <td><%= resultAdmin[i].assignedToName %></td>
                                                  <td><%= resultAdmin[i].status %></td>
                                                  <td>
                                                      <button type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#exampleModal" data-bug="<%= resultAdmin[i].bugID %>">View More</button>
                                                  </td>
                  							</tr>

                                          <% } %>
                                      <% } %>
              						</tbody>
              					</table>
            					</div>

                        <% } %> <!-- Closed bugs -->

                        <% if(state == 'approve') { %>
                            <div class="panel panel-primary resp">
            					<div class="panel-heading">
            						<h3 class="panel-title">Bugs pending approval</h3>
            						<div class="pull-right">
            							<span class="clickable filter" data-toggle="tooltip" title="Toggle table filter" data-container="body">
                                            <i class="fa fa-filter" aria-hidden="true"></i>
            							</span>
            						</div>
            					</div>
            					<div class="panel-body">
            						<div class="panel-filter">
            						  <input type="text" class="form-control" id="dev-table-filter" data-action="filter" data-filters="#dev-table" placeholder="Filter Bugs" />
            						</div>
                        <table class="table table-hover" id="dev-table">
              						<thead>
              							<tr>
              								<th>Bug #</th>
              								<th>Name</th>
              								<th>Type</th>
                                              <th>Severity</th>
                                              <th>Priority</th>
                                              <th>Project</th>
                                              <th>Assigned to</th>
                                              <th></th>
              							</tr>
              						</thead>
                                      <tbody>
                                      <% for(i=0; i<resultAdmin.length; i++) {%>
                                          <% if(resultAdmin[i].status == 'Approval') {%>

                                              <tr>
                  								<td class="bug_id"><%= resultAdmin[i].bugid %></td>
                  								<td><%= resultAdmin[i].bugname %></td>
                  								<td><%= resultAdmin[i].bugtype %></td>
                                                  <td><%= resultAdmin[i].severity %></td>
                                                  <td><%= resultAdmin[i].priority %></td>
                                                  <td><%= resultAdmin[i].projectName %></td>
                                                  <td><%= resultAdmin[i].assignedto %></td>
                                                  <td class="text-center">
                                                      <button type="button" class="btn btn-sm btn-success" data-toggle="modal" data-target="#exampleModal" data-bug="<%= resultAdmin[i].bugid %>">View More</button>
                                                  </td>
                  							</tr>

                                          <% } %>
                                      <% } %>
              						</tbody>
              					</table>
            					</div>

                        <% } %> <!--If state is unassigned -->

                    <% } %> <!--If admin -->
				</div>
			</div>
		</div>
	</div>
  <script src="/conditionalPaging.js" charset="utf-8"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $('#dev-table').DataTable({
        "searching": false,
        "lengthChange": false,
        "info": false,
        "conditionalPaging": true,
        "order": [[ 0, "desc" ]]
      });
    } );
  </script>
  <script src="/jquery.dataTables.min.js" charset="utf-8"></script>
  <script src="/dataTables.bootstrap.min.js" charset="utf-8"></script>

    <script src="/table.js" charset="utf-8"></script>
    <% if(typeof(resultAdmin) != 'undefined') { %>
        <% if(state == 'unassigned') { %>
            <script src="/assignDeveloper.js" charset="utf-8"></script>
        <% } %>
        <% if(state == 'approve') { %>
            <script src="/adminStatusUpdate.js" charset="utf-8"></script>
            <script src="/rejectReason.js" charset="utf-8"></script>
        <% } %>
    <% } %>
    <script src="/axios.min.js" charset="utf-8"></script>
    <script src="/getBugDetailsDev.js" charset="utf-8"></script>
    <!-- <link rel="stylesheet" href="https://cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css"> -->
    <link rel="stylesheet" type="text/css" href="/style/bugReports.css">
    <script src="/moment.min.js" charset="utf-8"></script>
    </body>
</html>
